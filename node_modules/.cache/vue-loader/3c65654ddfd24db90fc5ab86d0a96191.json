{"remainingRequest":"D:\\Projects\\Vue\\NEW\\vue-spas-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Projects\\Vue\\NEW\\vue-spas-master\\src\\App.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\Projects\\Vue\\NEW\\vue-spas-master\\src\\App.vue","mtime":1617117837101},{"path":"D:\\Projects\\Vue\\NEW\\vue-spas-master\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\Projects\\Vue\\NEW\\vue-spas-master\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Projects\\Vue\\NEW\\vue-spas-master\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Projects\\Vue\\NEW\\vue-spas-master\\node_modules\\sass-loader\\lib\\loader.js","mtime":1533139052000},{"path":"D:\\Projects\\Vue\\NEW\\vue-spas-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Projects\\Vue\\NEW\\vue-spas-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n$primary: #05b2dd;\n@import \"node_modules/bootstrap/scss/bootstrap\";\n",{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2KA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\">\n    <Navigation\n      :user=\"user\"\n      :userstate=\"userstate\"     \n      :isAdmin=\"isAdmin\"\n      :isDonor=\"isDonor\"\n      :isDriver=\"isDriver\"\n      @logout=\"logout\"\n    />\n    <router-view\n      class=\"container\"\n      :user=\"user\"\n      :userstate=\"userstate\"     \n      :isAdmin=\"isAdmin\"\n      :isDonor=\"isDonor\"\n      :isDriver=\"isDriver\"\n      :meetings=\"meetings\"\n      :error=\"error\"\n      @logout=\"logout\"\n      @addMeeting=\"addMeeting\"\n      @deleteMeeting=\"deleteMeeting\"\n      @checkIn=\"checkIn\"\n    />\n  </div>\n</template>\n\n<script>\nimport Navigation from \"@/components/Navigation.vue\";\nimport firebase from \"firebase\";\nimport db from \"./db.js\";\n\nexport default {\n  name: \"App\",\n  data: function() {\n    return {\n      user: null,\n      error: null,\n      meetings: [],\n       userstate:false,\n      isAdmin:false,\n      isDriver: false,\n      isDonor: false\n    };\n  },\n  methods: {\n    logout: function() {\n      firebase.auth()\n        .signOut()\n        .then(() => {\n          this.isAdmin = false;\n          this.isDriver = false;\n          this.isDonor = false;\n          this.user = null; //reset user\n          this.$router.push(\"login\"); //reroute to login\n        });\n    },\n    addMeeting: function(payload) {\n      db.collection(\"users\")\n        .doc(this.user.uid)\n        .collection(\"meetings\")\n        .add({\n          name: payload,\n          createdAt: Firebase.firestore.FieldValue.serverTimestamp()\n        });\n    },\n    deleteMeeting: function(payload) {\n      db.collection(\"users\")\n        .doc(this.user.uid)\n        .collection(\"meetings\")\n        .doc(payload)\n        .delete();\n    },\n    checkIn: function(payload) {\n      console.log(payload)\n      db.collection(\"users\")\n        .doc(payload.userID)\n        .collection(\"meetings\")\n        .doc(payload.meetingID)\n        .get()\n        .then(doc => {\n          if (doc.exists) {\n            db.collection(\"users\")\n              .doc(payload.userID)\n              .collection(\"meetings\")\n              .doc(payload.meetingID)\n              .collection(\"attendees\")\n              .add({\n                displayName: payload.displayName,\n                eMail: payload.eMail,\n                createdAt: Firebase.firestore.FieldValue.serverTimestamp()\n              })\n              .then(() =>\n                this.$router.push(\n                  \"/attendees/\" + payload.userID + \"/\" + payload.meetingID\n                )\n              );\n          } else {\n            this.error = \"Sorry, no such meeting\";\n          }\n        });\n    }\n  },\n  mounted() {\n    // Firebase.auth().onAuthStateChanged(user => {\n    //    console.log(user)\n    //   if (user) {\n    //     this.user = user;\n\n    //     db.collection(\"users\")\n    //       .doc(this.user.uid)\n    //       .collection(\"meetings\")\n    //       .onSnapshot(snapshot => {\n    //         const snapData = [];\n    //         snapshot.forEach(doc => {\n    //           snapData.push({\n    //             id: doc.id,\n    //             name: doc.data().name\n    //           });\n    //         });\n    //         this.meetings = snapData.sort((a, b) => {\n    //           if (a.name.toLowerCase() < b.name.toLowerCase()) {\n    //             return -1;\n    //           } else {\n    //             return 1;\n    //           }\n    //         });\n\n             \n    //       });\n    //   }\n    // });\n\n    firebase.auth().onAuthStateChanged(user => {\n            if (user) {  \n                this.userstate = true;\n            } else { \n                this.userstate = false;\n            } \n        });\n        \n        //check user roles\n         firebase.auth().onAuthStateChanged(userAuth => {\n            if (userAuth) {\n                firebase\n                    .auth()\n                    .currentUser.getIdTokenResult()\n                    .then(tokenResult => {\n                        console.log('tokenResult.claims.donor: ' + tokenResult.claims)\n                        if(tokenResult.claims.admin){\n                            this.isAdmin = true\n                        }else if(tokenResult.claims.driver){\n                            this.isDriver = true\n                        }else if(tokenResult.claims.donor){\n                            this.isDonor = true\n                        }\n                         console.log(this.isAdmin)\n                    });\n            }         \n          });\n      },\n   \n  \n  components: {\n    Navigation\n  }\n};\n</script>\n\n\n<style lang=\"scss\">\n$primary: #05b2dd;\n@import \"node_modules/bootstrap/scss/bootstrap\";\n</style>\n"]}]}